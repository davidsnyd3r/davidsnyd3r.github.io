<!DOCTYPE HTML>
<!--
    David Snyder Personal Page
    html5up.net | @ajlkn
    Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
<head>
    <title>David Snyder Personal Page</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="assets/css/main.css" />
    <noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
    <style>
        #image-container {
            width: 300px;
            height: 300px;
            border: 1px solid #ccc;
            margin: 20px auto;
            overflow: hidden;
            display: none;
        }
        #uploaded-image {
            max-width: 100%;
            max-height: 100%;
            display: block;
            margin: auto;
        }
        #upload-box {
            border: 2px dashed #aaa;
            padding: 20px;
            text-align: center;
            cursor: pointer;
        }
    </style>
</head>
<body class="is-preload">

<!-- Wrapper -->
<div id="wrapper" class="fade-in">

    <!-- Main -->
    <div id="main">
        <!-- Upload Box -->
        <div id="upload-box">
            <h2>Upload Photo</h2>
            <p>Click the button below to choose an image file.</p>
            <!-- File input -->
            <input type="file" id="file" accept="image/*" style="display: none;">
            <!-- Browse button -->
            <button id="upload-button">Select File</button>
        </div>

        <!-- Image Container -->
        <div id="image-container">
            <img id="uploaded-image" src="#" alt="Uploaded Image">
        </div>

        <!-- Prediction Result -->
        <section id="prediction-result" style="display: none;">
            <h2>Prediction Result</h2>
            <div id="result"></div>
        </section>
    </div>

    <!-- TensorFlow.js Script -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.9.0"></script>
    <script>
        // Load the TensorFlow.js model
        async function loadModel() {
            const model = await tf.loadLayersModel('model.json');
            return model;
        }

        // Make predictions using the loaded model
        async function predict(imageData, model) {
            // Preprocess image data if necessary
            // Perform prediction using the loaded model
            const prediction = model.predict(imageData);
            return prediction;
        }

        // Function to handle image upload
        function handleUpload(event) {
            const file = event.target.files[0];
            const reader = new FileReader();
            reader.onload = function (e) {
                handleImage(e.target.result);
            };
            reader.readAsDataURL(file);
        }

        // Function to handle image display and prediction
        async function handleImage(imageData) {
            // Display the image
            const img = document.createElement('img');
            img.src = imageData;
            img.onload = function () {
                document.getElementById('image-container').appendChild(img);
            };

            // Preprocess the image
            const imgTensor = tf.browser.fromPixels(img).toFloat();

            // Make prediction
            const prediction = await predict(imgTensor.expandDims(0), model);

            // Display prediction result
            const predictionLabel = getPredictionLabel(prediction);
            document.getElementById('result').innerText = 'Prediction: ' + predictionLabel;

            // Show prediction result section
            document.getElementById('prediction-result').style.display = 'block';
        }

        // Set up event listener for file input change
        const fileInput = document.getElementById('file');
        fileInput.addEventListener('change', handleUpload);

        // Set up event listener for browse button click
        const uploadButton = document.getElementById('upload-button');
        uploadButton.addEventListener('click', function () {
            // Trigger click event on file input
            fileInput.click();
        });

        // Load the model once the DOM content is loaded
        document.addEventListener('DOMContentLoaded', async function () {
            const model = await loadModel();
            // Store model in a global variable for later use
            window.model = model;
        });
    </script>
</div>
</body>
</html>
